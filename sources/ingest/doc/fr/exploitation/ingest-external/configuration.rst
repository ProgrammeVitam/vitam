Configuration / fichiers utiles
###############################

Les fichiers de configuration sont gérés par les procédures d'installation ou de mise à niveau de l'environnement :term:`VITAM`. Se référer au :term:`DIN`.

Les fichiers de configuration sont définis sous ``/vitam/conf/ingest-external``.

Fichier ``ingest-external.conf``
---------------------------------

.. literalinclude:: ../../../../../../deployment/ansible-vitam/roles/vitam/templates/ingest-external/ingest-external.conf.j2
   :language: yaml


Ce fichier contient un appel au shell d'antivirus (par défaut, ClamAV) ;  se reporter au :term:`DIN`.

Il est possible, dans le cas de fichiers SIP volumineux, d'héberger des fichiers directement dans ingest-external (valeur de la directive ``baseUploadPath``). Ces fichiers doivent être accessibles et utilisables par le `user` système vitam.

Les options associées à cette fonctionnalité peuvent être paramétrées dans le fichier deployment/environment/group_vars/all/advanced/vitam_vars.yml avant installation de Vitam.

La directive ``fileActionAfterUpload`` accepte les valeurs :

    - ``NONE`` : le fichier reste
    - ``MOVE`` : déplace le fichiers vers les valeurs des directives ``successfulUploadDir`` (en cas de succès de l'ingest) et ``failedUploadDir`` (en cas de non-succès de l'ingest)
    - ``DELETE``  : le fichier est supprimé en cas de succès de l'ingest uniquement

A charge à l'exploitant de bien gérer l'espace disque de ces répertoires (il faut penser aux ingests en échecs par exemple).

Se reporter au manuel de développement pour l'appel d'API associé.

Fichier ``ingest-internal-client.conf``
----------------------------------------

.. literalinclude:: ../../../../../../deployment/ansible-vitam/roles/vitam/templates/ingest-external/ingest-internal-client.conf.j2
   :language: yaml

Fichier ``internal-security-client.conf``
-----------------------------------------

.. literalinclude:: ../../../../../../deployment/ansible-vitam/roles/vitam/templates/ingest-external/internal-security-client.conf.j2
   :language: yaml

Fichier ``format-identifiers.conf``
-----------------------------------

.. literalinclude:: ../../../../../../deployment/ansible-vitam/roles/vitam/templates/ingest-external/format-identifiers.conf.j2
   :language: yaml

Fichier ``functional-administration-client.conf``
--------------------------------------------------

.. literalinclude:: ../../../../../../deployment/ansible-vitam/roles/vitam/templates/ingest-external/functional-administration-client.conf.j2
   :language: yaml


Fichier ``scan-clamav.sh``
--------------------------

Ce script de *scan* appelle l'antivirus (par défaut, clamAV ; ce paramètre est surchargeable à l'installation ; se référer au :term`DIN` pour plus de précisions) pour détecter les virus.

.. literalinclude:: ../../../../../../deployment/environments/antivirus/scan-clamav.sh
   :language: shell
