restic
######

Outil de sauvegarde opensource. Utilisé pour le backup des bases mongo-offer.

Supporte les différents providers suivants: `filesystem`, `filesystem-hash`, `openstack-swift-v3` et `amazon-s3-v1`.

.. note:: La sauvegarde des bases pour les offres froides est détaillée dans le :term:`DEX`.

Type :
  COTS EXTRA (beta)

Données stockées :
  * Sauvegarde des bases mongodb.


Architecture de déploiement
===========================

restic sera déployé sur l'ensemble des machines renseignées dans le groupe ``[hosts_storage_offer_default]`` de votre fichier d'inventaire qui possèdent le paramètre ``restic_enabled=true``. Attention à ne mettre ce paramètre que pour l'une des machines pour chacun des ``offer_conf``.

Afin de permettre aux machines du groupe ``[hosts_storage_offer_default]`` de faire les backups, elles doivent pouvoir accéder aux bases de données afin de pouvoir effectuer la commande `mongodump`. Ainsi, les flux réseaux doivent permettre d'atteindre les bases configurées (``{{ restic.backup.host }}``).

Pour des raisons de sécurité, restic est déployé sur ces machines afin d'éviter de diffuser les paramètres d'accès aux offres de stockage (notamment dans le cas des offres objet).

De plus, en cas de défaillance critique du système Vitam, tant que les offres de stockage sont intactes, il sera plus facile de ressortir les snapshots des bases de données associées aux données de l'offre sous-jacente.
