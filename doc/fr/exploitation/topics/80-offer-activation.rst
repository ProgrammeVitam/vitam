
.. _activation_offre:

Activation/désactivation d'une offre
####################################

.. caution:: Ne pas oublier, en cas de désactivation d'une offre considérée référente par :term:`VITAM`, de déclarer une autre offre (contenant les données) comme nouvelle référente (modifications à apporter dans ``deployment/environments/group_vars/all/offers_opts.yml`` par la directive ``referent: true``).

Lors de la détection de la perte d'une offre de stockage ou lors d'une maintenance programmée sur celle-ci, afin de permettre à nouveau les versements, l'offre pourra être désactivée.

La désactivation d'une offre s'effectue selon la procédure suivante :

* Exécuter la commande suivante afin de désactiver l'offre :

    .. code-block:: bash

        ansible-playbook ansible-vitam-exploitation/activate_vitam_offer.yml -i environments/hosts.<environnement> --ask-vault-pass

Rentrer (entre quotes) le nom de l'offre (parmi les offres listées par la question) à activer/désactiver en réponse à la question suivante::

    Which offer do you want to disable ?
       nom-offre-1
       nom-offre-2
       ...
       nom-offre-n
      : "nom-offre-x"

Choisir l'action à réaliser en répondant à la question suivante::

    Do you want to enable (yes) or to disable (no) the chosen offer ?
    Answer with ('yes'|'no') : no

Signification de la réponse:

* **yes**: active l'offre choisie
* **no**: désactive l'offre choisie

.. warning:: Cette opération provoque une indisponibilité complète de :term:`VITAM`

* Exécuter la commande suivante afin de reconfigurer le composant storage-engine:

    .. code-block:: bash

        ansible-playbook ansible-vitam/vitam.yml -i environments/hosts.<environnement> --ask-vault-pass --limit hosts_storage_engine --tags update_vitam_configuration

.. warning:: Cette opération provoque une indisponibilité temporaire des principaux services :term:`VITAM` (versement, gestion, recherche et consultation)
