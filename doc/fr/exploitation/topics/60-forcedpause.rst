Procédure d'exploitation pour la mise en pause forcée d'une opération
###############################################################################

Pour permettre le traitement non concurent de certaines opérations (ingest et reclassement en particulier), il est possible de pouvoir forcer la mise en pause à la réception d'opérations à leur réception (toutes ou seulement d'un type donnée, sur tout les tenants ou un tenant donné en particulier)

Concrètement, elle permet de forcer le mode "pas à pas" pour toutes ou un type donné seulement d'opération, sur l'ensemble des tenants ou sur un tenant donné seulement.


Mise en pause forcée
====================

La mise en pause forcée est déclenché par l'appel au point d'API porté par l'URL suivante : ``http://{{ ip_admin }}:{{ vitam.metadata.port_admin }}/admin-external/v1/forcepause``

Exemple d'appel à l'aide de curl : 


.. code-block:: bash 

	curl -X POST -k 
	--key vitam-vitam_1.key 
	--cert vitam-vitam_1.pem 
	``http://{{ ip_admin }}:{{ vitam.metadata.port_admin }}/admin-external/v1/forcepause``
	-H 'X-Tenant-Id: 0' 
	-H 'X-Access-Contract-Id: ContratTNR' 
	-H 'Content-Type: application/json;charset=UTF-8' 
	-H 'Accept: application/json' 
	--data-binary '{"type" : "INGEST", "tenant" : "0"}'
	--compressed


Exemple de Json pour mettre une pause sur le processus d'ingest pour le tenant 0 : 

.. code:: json
	'{"type" : "INGEST", "tenant" : "0"}'


Exemple de Json pour mettre une pause sur tous les processus pour le tenant 0 : 

.. code:: json
	'{"tenant" : "0"}'

Exemple de Json pour mettre une pause sur tous les processus pour tous les tenants : 

.. code:: json
	'{"pauseAll":true}'


Sortie de la mise en pause forcée
============================================

La sortie mise en pause forcée est déclenché par l'appel au point d'API porté par l'URL suivante : ``http://{{ ip_admin }}:{{ vitam.metadata.port_admin }}/admin-external/v1/removeforcepause``

Exemple d'appel à l'aide de curl : 


.. code-block:: bash 

	curl -X POST -k 
	--key vitam-vitam_1.key 
	--cert vitam-vitam_1.pem 
	``http://{{ ip_admin }}:{{ vitam.metadata.port_admin }}/admin-external/v1/removeforcepause``
	-H 'X-Tenant-Id: 0' 
	-H 'X-Access-Contract-Id: ContratTNR' 
	-H 'Content-Type: application/json;charset=UTF-8' 
	-H 'Accept: application/json' 
	--data-binary '{"type" : "INGEST", "tenant" : "0"}'
	--compressed

Exemple de Json pour sortir de la mise en pause sur le processus d'ingest pour le tenant 0 : 

.. code:: json
	'{"type" : "INGEST", "tenant" : "0"}'


Exemple de Json pour sortir de la mise en pause sur tous les processus pour le tenant 0 : 

.. code:: json
	'{"tenant" : "0"}'

Exemple de Json pour sortir de la mise en pause sur tous les processus pour tous les tenants : 

.. code:: json
	'{"pauseAll":false}'


.. warning:: Les états de mise en pause ne sont pas sauvegardés. En cas de redémarrage des applications ces états seront perdus.
