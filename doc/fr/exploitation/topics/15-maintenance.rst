Interruption / maintenance
##########################


Procédure d'arrêt
=================

Cette procédure décrit la cinématique d'arrêt de la plate-forme ; les commandes pour chaque composant sont détaillées plus bas dans ce même document.


.. note:: Il est conseillé de n'arrêter les bases de données qu'une fois les composants applicatifs arrêtés.

.. csv-table:: Cinématique d'arrêt de VITAM
   :header: "Composant", "Ordre d'arrêt","OK ?"
   :widths: 15, 5,10

   "ihm-demo","1",""
   "ingest-external","2",""
   "ingest-internal","3",""
   "access-external","4",""
   "access-internal","5",""
   "worker","6",""
   "processing","7",""
   "workspace","8",""
   "functional-administration","9",""
   "logbook","10",""
   "metadata","11",""
   "storage-engine","12",""
   "storage-offer-xxx","13",""
   "mongos","14",""
   "mongod","15",""
   "mongoc","16",""
   "elasticsearch vitam","17",""
   "kibana","18",""
   "logstash","19",""
   "elasticsearch logs","20",""
   "consul","21",""


Un playbook ansible d'arrêt de VITAM est fourni, sous ``deployment/ansible-vitam-exploitation``  (fichier de *playbook* ``stop_vitam.yml``), pour réaliser de façon automatisée les actions nécessaires.

.. warning:: ce script, en l'état, permet un `EMERGENCY BREAK`, autrement dit un arrêt brutal des composants, ne permettant pas de garantir, à l'issue, une cohérence  des données.

.. note:: Une confirmation est demandée pour lancer ce script d'arrêt de la solution logicielle VITAM.

Procédure de démarrage
======================

Le pré-requis est le bon fonctionnement des partitions hébergeant la solution logicielle :term:`VITAM`.

.. csv-table:: Cinématique de démarrage de :term:`VITAM`
   :header: "Composant", "Ordre","OK ?"
   :widths: 15, 5,10

   "consul","1",""
   "elasticsearch logs","2",""
   "logstash","3",""
   "kibana","4",""
   "elasticsearch vitam","5",""
   "mongoc","6",""
   "mongod","7",""
   "mongos","8",""
   "storage-offer-xxx","9",""
   "storage-engine","10",""
   "metadata","11",""
   "logbook","12",""
   "functional-administration","13",""
   "workspace","14",""
   "processing","15",""
   "worker","16",""
   "access-internal","17",""
   "access-external","18",""
   "ingest-internal","19",""
   "ingest-external","20",""
   "ihm-demo","21",""

Un playbook ansible de démarrage de VITAM est fourni, sous ``deployment/ansible-vitam-exploitation`` (fichier de *playbook* ``start_vitam.yml``), pour réaliser de façon automatisée les actions nécessaires.

Procédure de statut
======================

Un playbook ansible de démarrage de VITAM est fourni, sous ``deployment/ansible-vitam-exploitation`` (fichier de *playbook* ``status_vitam.yml``), pour réaliser de façon automatisée les tests "autotest" intégérés dans la solution logicielle VITAM.

