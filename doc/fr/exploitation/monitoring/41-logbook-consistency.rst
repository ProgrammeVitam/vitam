Cohérence des journaux
######################

Il existe un outil d'administration utilisable par l'exploitant afin de réaliser un test de cohérence des journaux.
Cet outil permet de vérifier que les données enregistrées dans la collection LogbookOperations sont bien en cohérence avec les informations sauvegardées dans les collections LFC.

Actuellement, seuls les :term:`TNR` utilisent le point d'API.

A l'avenir, il sera possible de préciser les modalités dans un fichier json associé, et il sera possible d'utiliser le contrôle de cohérence indépendamment.

Lancement
=========

Pour lancer l'outil de cohérence, il suffit de lancer une requête (``curl``, par exemple) sur le serveur logbook interne (sur la "patte" d'administration) :

 - POST sur le endpoint /checklogbook
 
Résultat
========

L'outil de cohérence renvoie un code OK, si l'opération s'est bien déroulée. 
En cas d'erreur interne, un code HTTP 500 sera renvoyé.

Dans le cadre d'un OK, un rapport au format Json sera généré, et sera enregistré sur les offres de stockage.

Le rapport contiendra les informations suivantes : 

 * checkedEvents : la liste des évènements vérifiés.
 * checkErrors : la liste des erreurs constatées.
