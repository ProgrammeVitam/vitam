---

- name: stop scheduling jobs
  uri:
    url: "http://{{ ip_admin }}:{{ vitam_struct.port_admin }}/scheduler/v1/pause/ALL"
    method: PUT
    headers:
     Connection: "keep-alive"
     Host: "{{ vitam_struct.host }}"
    status_code: 202, -1
  register: scheduling_status
  tags:
    - always

- name: check scheduling status
  fail:
    msg: 'Cannot stop Vitam scheduling : ignore error if vitam-scheduler already stopped or Scheduler is not yet installed'
  when: scheduling_status.status == -1
  ignore_errors: yes
  tags:
    - always