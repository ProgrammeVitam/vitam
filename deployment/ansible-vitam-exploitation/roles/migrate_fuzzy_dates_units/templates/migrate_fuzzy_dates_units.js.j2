db.getSiblingDB('metadata').Unit.find(

    {
        $and: [
            { "_fuzzyCD": { $exists: false } },
            { "_fuzzyUD": { $exists: false } }
        ]
    }

).forEach(function(unit) {
    var logbook = db.getSiblingDB('logbook').LogbookLifeCycleUnit.findOne({
        "_id": unit._id
    });

    if (logbook &&  logbook.events && logbook.events.length > 0) {
        
          var lastEvent = logbook.events[logbook.events.length - 1];
          unit._fuzzyCD = logbook.evDateTime;
          unit._fuzzyUD = lastEvent.evDateTime;
           
          db.getSiblingDB('metadata').Unit.update({
              _id: unit._id
          }, unit);
    }

})