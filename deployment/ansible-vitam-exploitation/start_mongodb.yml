---

- hosts: hosts_mongoc_data
  gather_facts: no
  any_errors_fatal: true
  roles:
    - service
  vars:
    service_state: "{% if 'mongoc' not in vitam_secondary_site_components and primary_site| lower == 'false' %}stopped{% else %}started{% endif %}"
    service_name: vitam-mongoc
    service_host: "{{ ip_service }}"
    service_port: "{{ mongodb.mongoc_port }}"
    service_timeout: "{{ vitam_defaults.services.start_timeout }}"
  tags:
    - data

- hosts: hosts_mongod_data
  gather_facts: no
  any_errors_fatal: true
  roles:
    - service
  vars:
    service_state: "{% if 'mongod' not in vitam_secondary_site_components and primary_site| lower == 'false' %}stopped{% else %}started{% endif %}"
    service_name: vitam-mongod
    service_host: "{{ ip_service }}"
    service_port: "{{ mongodb.mongod_port }}"
    service_timeout: "{{ vitam_defaults.services.start_timeout }}"
  tags:
    - data

- hosts: hosts_mongos_data
  gather_facts: no
  any_errors_fatal: true
  roles:
    - service
  vars:
    service_state: started
    service_name: vitam-mongos
    service_host: "{{ ip_service }}"
    service_port: "{{ mongodb.mongos_port }}"
    service_timeout: "{{ vitam_defaults.services.start_timeout }}"
  tags:
    - data

- hosts: hosts_mongoc_offer
  gather_facts: no
  any_errors_fatal: true
  roles:
    - service
  vars:
    service_state: started
    service_name: vitam-mongoc
    service_host: "{{ ip_service }}"
    service_port: "{{ mongodb.mongoc_port }}"
    service_timeout: "{{ vitam_defaults.services.start_timeout }}"
  tags:
    - offer

- hosts: hosts_mongod_offer
  gather_facts: no
  any_errors_fatal: true
  roles:
    - service
  vars:
    service_state: started
    service_name: vitam-mongod
    service_host: "{{ ip_service }}"
    service_port: "{{ mongodb.mongod_port }}"
    service_timeout: "{{ vitam_defaults.services.start_timeout }}"
  tags:
    - offer

- hosts: hosts_mongos_offer
  gather_facts: no
  any_errors_fatal: true
  roles:
    - service
  vars:
    service_state: started
    service_name: vitam-mongos
    service_host: "{{ ip_service }}"
    service_port: "{{ mongodb.mongos_port }}"
    service_timeout: "{{ vitam_defaults.services.start_timeout }}"
  tags:
    - offer
