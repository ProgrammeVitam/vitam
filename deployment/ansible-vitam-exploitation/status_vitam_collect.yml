---

- hosts: hosts_metadata_collect
  gather_facts: no
  any_errors_fatal: false
  roles:
    - { role: vitam_autotest, when: ( primary_site | lower == "true" ) or ( vitam_component in vitam_secondary_site_components ) }
  vars:
    vitam_component: "{{ vitam.metadata_collect.vitam_component }}"
    hote: "{{ ip_admin }}"
    hote_service: "{{ ip_service }}"
    check_port: "{{ vitam.metadata_collect.port_admin }}"
    check_port_service: "{{ vitam.metadata_collect.port_service }}"

- hosts: hosts_workspace_collect
  gather_facts: no
  any_errors_fatal: false
  roles:
    - { role: vitam_autotest, when: ( primary_site | lower == "true" ) or ( vitam_component in vitam_secondary_site_components ) }
  vars:
    vitam_component: "{{ vitam.workspace_collect.vitam_component }}"
    hote: "{{ ip_admin }}"
    hote_service: "{{ ip_service }}"
    check_port: "{{ vitam.workspace_collect.port_admin }}"
    check_port_service: "{{ vitam.workspace_collect.port_service }}"

- hosts: hosts_collect_internal
  gather_facts: no
  any_errors_fatal: false
  roles:
    - { role: vitam_autotest, when: ( primary_site | lower == "true" ) or ( vitam_component in vitam_secondary_site_components ) }
  vars:
    vitam_component: "{{ vitam.collect_internal.vitam_component }}"
    hote: "{{ ip_admin }}"
    hote_service: "{{ ip_service }}"
    check_port: "{{ vitam.collect_internal.port_admin }}"
    check_port_service: "{{ vitam.collect_internal.port_service }}"

- hosts: hosts_collect_internal
  any_errors_fatal: false
  roles:
    - vitam_check_port
  vars:
    vitam_component: "siegfried"
    hote: "localhost"
    check_port: "{{ siegfried.port }}"
  gather_facts: no

- hosts: hosts_collect_external
  gather_facts: no
  any_errors_fatal: false
  roles:
    - { role: vitam_autotest, when: ( primary_site | lower == "true" ) or ( vitam_component in vitam_secondary_site_components ) }
  vars:
    vitam_component: "{{ vitam.collect_external.vitam_component }}"
    hote: "{{ ip_admin }}"
    hote_service: "{{ ip_service }}"
    check_port: "{{ vitam.collect_external.port_admin }}"
    check_port_service: "{{ vitam.collect_external.port_service }}"