---

- hosts: localhost
  any_errors_fatal: yes
  gather_facts: no
  vars_prompt:
    name: "confirmation"
    prompt: "/!\\ WARNING : This playbook will cleanup your Vitam elasticsearch-data indexes.\n\nAre you sure you want to run this playbook ?\nAnswer with 'YES'"
    default: "NO"
    private: no
  tasks:
    - name: Check Confirmation
      fail: msg="Playbook run confirmation failed"
      when: confirmation|upper != "YES"

- hosts: vitam
  any_errors_fatal: true
  gather_facts: no
  roles:
    - { role: service, when: consul_disabled is not defined or consul_disabled |lower != 'true' }
  vars:
    service_state: "started"
    service_name: vitam-consul

- hosts: hosts_elasticsearch_data
  roles:
    - clean_indexes_es_data
  run_once: true
