---

- hosts: hosts_metadata_collect
  serial: 1
  any_errors_fatal: true
  gather_facts: no
  roles:
    - service
  vars:
    service_state: "{% if 'metadata-collect' not in vitam_secondary_site_components and primary_site | lower == 'false' %}stopped{% else %}started{% endif %}"
    service_name: vitam-metadata-collect
    service_host: "{{ ip_service }}"
    service_port: "{{ vitam.metadata_collect.port_service }}"
    service_timeout: "{{ vitam_defaults.services.start_timeout }}"

- hosts: hosts_workspace_collect
  any_errors_fatal: true
  gather_facts: no
  roles:
    - service
  vars:
    service_state: "{% if 'workspace-collect' not in vitam_secondary_site_components and primary_site | lower == 'false' %}stopped{% else %}started{% endif %}"
    service_name: vitam-workspace-collect
    service_host: "{{ ip_service }}"
    service_port: "{{ vitam.workspace_collect.port_service }}"
    service_timeout: "{{ vitam_defaults.services.start_timeout }}"

- hosts: hosts_collect_internal
  any_errors_fatal: true
  gather_facts: no
  roles:
    - service
  vars:
    service_state: "{% if 'siegfried' not in vitam_secondary_site_components and primary_site| lower == 'false' %}stopped{% else %}started{% endif %}"
    service_name: vitam-siegfried
    


- hosts: hosts_collect_internal
  any_errors_fatal: true
  gather_facts: no
  roles:
    - service
  vars:
    service_state: "{% if 'collect-internal' not in vitam_secondary_site_components and primary_site | lower == 'false' %}stopped{% else %}started{% endif %}"
    service_name: vitam-collect-internal
    service_host: "{{ ip_service }}"
    service_port: "{{ vitam.collect_internal.port_service }}"
    service_timeout: "{{ vitam_defaults.services.start_timeout }}"

- hosts: hosts_collect_external
  gather_facts: no
  any_errors_fatal: true
  roles:
    - service
  vars:
    service_state: "{% if 'collect-external' not in vitam_secondary_site_components and primary_site| lower == 'false' %}stopped{% else %}started{% endif %}"
    service_name: vitam-collect-external
    service_host: "{{ ip_service }}"
    service_port: "{{ vitam.collect_external.port_service }}"
    service_timeout: "{{ vitam_defaults.services.start_timeout }}"
