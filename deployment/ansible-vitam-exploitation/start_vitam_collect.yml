---

- hosts: hosts_metadata_collect
  serial: 1
  any_errors_fatal: true
  gather_facts: no
  roles:
    - service
  vars:
    state: "{% if 'metadata-collect' not in vitam_secondary_site_components and primary_site | lower == 'false' %}stopped{% else %}started{% endif %}"
    name: vitam-metadata-collect
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.metadata_collect.port_service }}"
    timeout: "{{ vitam_defaults.services.start_timeout }}"

- hosts: hosts_workspace_collect
  any_errors_fatal: true
  gather_facts: no
  roles:
    - service
  vars:
    state: "{% if 'workspace-collect' not in vitam_secondary_site_components and primary_site | lower == 'false' %}stopped{% else %}started{% endif %}"
    name: vitam-workspace-collect
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.workspace_collect.port_service }}"
    timeout: "{{ vitam_defaults.services.start_timeout }}"

- hosts: hosts_collect
  any_errors_fatal: true
  gather_facts: no
  roles:
    - service
  vars:
    state: "{% if 'collect' not in vitam_secondary_site_components and primary_site | lower == 'false' %}stopped{% else %}started{% endif %}"
    name: vitam-collect
    hote: "{{ ip_service }}"
    port_check: "{{ vitam.collect.port_service }}"
    timeout: "{{ vitam_defaults.services.start_timeout }}"
